<!-- CSS -->
<style>
  body {
    background-color: #242325;
  } 

  h3 {
    margin: 8px 0px;
  }

  div.tab {
    top: 0px;
    left: 0px;
    display: inline;
  }

  div.tab svg {
    width: 135px;
    height: 33.75px;
    margin-right: -30px;
    top: 0px; 
    display: inline-flex;
    justify-content: center;
    align-items: center;
  }

  div.tab svg path{
    fill: blue;
  }

  div.tab svg text {
    fill: red;
  }

  div.tab svg path, div.tab svg text {
    position: absolute;
    transform-origin: center;
}

  /* toolobj chips */

  div.tool-obj {
    display: inline-flex;
    width: fit-content;
    border-radius: 12px;
    background-color: red;
  }

  div.tool-obj p {
    margin: 8px;
  }
</style>

<!-- HTML -->
<div class="tab active" id="tab-mm">
  <svg width="180" height="45" viewBox="0 0 180 45" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M24.7226 12.0095L0 45H180L155.277 12.0095C149.612 4.44972 140.717 0 131.27 0H48.7297C39.2828 0 30.3878 4.44972 24.7226 12.0095Z" fill="#242325"/>
    <text x="0" y="15" fill="red">MirrorMult</text>
  </svg>
  <!-- <h1 id="page-mm">MirrorMult</h1> -->
</div>

<div class="tab" id="tab-rs">
  <svg width="180" height="45" viewBox="0 0 180 45" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M24.7226 12.0095L0 45H180L155.277 12.0095C149.612 4.44972 140.717 0 131.27 0H48.7297C39.2828 0 30.3878 4.44972 24.7226 12.0095Z" fill="#242325"/>
  </svg>
    
  <!-- <button id="page-rs">RotSymm</button> -->
<div>

<section id="hidden-mm" style="display: block;">
  <h1>MirrorMult</h1>
  
  <div class="tool-objs">
    <h3>Objects being mirrored:</h3>
    <div class="tool-objs-container"> 
      <!-- this is where the object chips go -->
    </div>   
  </div>

  <hr>
  
  <div id="direction">
    <h3>Mirror Direction</h3>
    <input type="checkbox" id="hori" value="1" name="mirrorDir">
    <svg width="12" height="12">
      <!-- put svg for arrow thing here -->
    </svg>    
    <label for="hori">Horizontal</label>
    
    <input type="checkbox" id="vert" value="2" name="mirrorDir">
    <svg width="12" height="12">
      <!-- put svg for arrow thing here -->
    </svg>    
    <label for="vert">Vertical</label>
  </div>

  <div id="origin-mm" class="origin">
    <span>Mirror Object:</span>
    <p style="display: inline;">No object selected</p> <!-- changes based on selected object --> 
  </div>

  <div class="mirror-obj">
    <label for="mirror-obj-mm">Use Empty Object</label>
    <input id="mirror-obj-mm" type="checkbox">
    <p class="empty-disclaimer">(will function the same as a regular object, but has axes for easier measurement and is deleted immediately after mirroring!)</span>
  </div>

  <div class="button">
    <button id="submit-mm">Mirror Selected Objects!</button>
  </div>

</section>

<section id="hidden-rs" style="display: none;">
  <h1>RotSymm</h1>

  <div class="tool-objs">
    <h3>Objects being rotated:</h3>
    <div class="tool-objs-container"> 
      <!-- this is where the object chips go -->
    </div>   
  </div>

  <hr>
  
  <div id="copies">
    <label for="num-copies">Number of Copies:</label>
    <input type="number" id="num-copies" min="2" step="1" value="2">
  </div>  

  <div id="origin-rs" class="origin">
    <span>Symmetry Origin:</span>
    <p style="display: inline;">No object selected</p> <!-- changes based on selected object --> 
  </div>

  <div class="mirror-obj">
    <label for="mirror-obj-rs">Use Empty Object</label>
    <input id="mirror-obj-rs" type="checkbox">
    <p class="empty-disclaimer">(will function the same as a regular object, but has axes for easier measurement and is deleted immediately after mirroring!)</span>
  </div>
  
  <div class="button">
    <button id="submit-rs">Rotationally Symmetrize!</button>
  </div>

</section>

<!-- need to work on:
* figuring out how empty origin obj checkbox will work (likely, changing sections will just uncheck the checkbox to make life easier)
  * will also require an event listener in TS to detect when checkbox changes
  * obviously, need to finish up rotsymm html + js postMessage
  * after this, html and js are essentially done methinks
-->

<!-- JS -->
<script>
  let toolObjs;

  window.onmessage = event => { // listens for change in selected object to update respective element
    const data = event.data.pluginMessage;

    const mirrorObjElem = document.querySelectorAll("div.origin p");
    const toolObjsDiv = document.querySelectorAll("div.tool-objs");

    let selectedObjName = data.selectedObj;
    toolObjs = data.toolObjNames;      

    for (const obj of mirrorObjElem) {
      if (selectedObjName) {
        obj.innerHTML = selectedObjName;
      }

      else {
        obj.innerHTML = "Not selected yet!"
      };
    };

    for (const toolElem of toolObjsDiv) {
      if (toolObjs.length >= 1) {
        const toolObjsFormat = toolObjs.map(obj => `
          <div class="tool-obj">
            <p>${obj}</p>
          </div>
        `)

        toolElem.innerHTML += toolObjsFormat.join('\n')
      }
      else {
        toolElem.innerHTML += 'No objects selected, make sure to select the objects you want symmetrized before running the plugin!';
      }
    }
  }
  

  // checkbox variables

  let msgFor = 0;

  const checkboxMM = document.getElementById('mirror-obj-mm');
  const checkboxRS = document.getElementById('mirror-obj-rs');

  // separate menu functionality

  // const buttonMM = document.getElementById("page-mm");
  // const buttonRS = document.getElementById("page-rs");

  const sectionMM = document.getElementById("hidden-mm");
  const sectionRS = document.getElementById("hidden-rs");

  const tabMM = document.getElementById('tab-mm')
  const tabRS = document.getElementById('tab-rs')
  
  tabMM.addEventListener('click', function() { // allows for the MirrorMult button to take user to the MirrorMult Menu, with its specific inputs
    sectionMM.style.display = 'block';
    sectionRS.style.display = 'none';

    checkboxRS.checked = false;

    tabMM.classList.add('active') // for the css
    tabRS.classList.remove('active')

    msgFor = 2; // lets code.ts know to delete the cursor as the checkbox has been unchecked
    parent.postMessage({pluginMessage: {msgFor}}, '*');
  });

  tabRS.addEventListener('click', function() { // allows for the RotSymm button to take user to the Rotsymm Menu, with its specific inputs
    sectionRS.style.display = 'block';
    sectionMM.style.display = 'none';

    checkboxMM.checked = false;
    
    tabRS.classList.add('active') // for the css
    tabMM.classList.remove('active')

    msgFor = 2; // lets code.ts know to delete the cursor as the checkbox has been unchecked
    parent.postMessage({pluginMessage: {msgFor}}, '*');
  });

  // checkbox shenanigans
  
  checkboxMM.addEventListener('change', function() {
    if (this.checked) {
      msgFor = 1; // lets code.ts know that the message is for the Empty Object checkbox
      parent.postMessage({pluginMessage: {msgFor}}, '*');
    }
    else {
      msgFor = 2;
      parent.postMessage({pluginMessage: {msgFor}}, '*');
    };
  });

  checkboxRS.addEventListener('change', function() {
    if (this.checked) {
      msgFor = 1;  // lets code.ts know that the message is for the Empty Object checkbox
      parent.postMessage({pluginMessage: {msgFor}}, '*');
    }
    else {
      msgFor = 2; // lets code.ts know to delete the cursor as the checkbox has been unchecked
      parent.postMessage({pluginMessage: {msgFor}}, '*');
    };
  });

  // posting form information

  document.getElementById('submit-mm').onclick = () => { // posts MirrorMult message
    const mirrorHori = document.getElementById('hori').checked; // holds either true or false depending if the option was selected
    const mirrorVert = document.getElementById('vert').checked; // holds either true or false depending if the option was selected

    msgFor = 3;

    parent.postMessage({pluginMessage: {msgFor, mirrorHori, mirrorVert}}, '*'); // sends the mirror direction(s) for MirrorMult
  }

  document.getElementById('submit-rs').onclick = () => { // posts RotSymm message
    const numCopies = document.getElementById('num-copies').value;

    msgFor = 4;

    parent.postMessage({pluginMessage: {msgFor, numCopies}}, '*');
    
  }
</script>